<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetris Game</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
        }
        .game-container {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        .game-board { position: relative; }
        canvas {
            border: 3px solid #fff;
            border-radius: 10px;
            background: #000;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        .game-info {
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-width: 200px;
        }
        .info-panel {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }
        .info-panel h3 { margin-bottom: 10px; font-size: 18px; }
        .score { font-size: 24px; font-weight: bold; color: #ffd700; }
        .level, .lines { font-size: 20px; color: #87ceeb; }
        .controls {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 15px;
        }
        .control-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }
        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3); }
        .btn:active { transform: translateY(0); }
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            display: none;
        }
        .game-over h2 { margin-bottom: 20px; color: #ff6b6b; }
        @media (max-width: 768px) {
            .game-container { flex-direction: column; padding: 20px; }
            canvas { width: 300px; height: 600px; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-board">
            <canvas id="gameCanvas" width="300" height="600"></canvas>
            <div class="game-over" id="gameOver">
                <h2>Game Over!</h2>
                <p>Skor Akhir: <span id="finalScore">0</span></p>
                <button class="btn" onclick="restartGame()">Main Lagi</button>
            </div>
        </div>
        
        <div class="game-info">
            <div class="info-panel"><h3>Skor</h3><div class="score" id="score">0</div></div>
            <div class="info-panel"><h3>Level</h3><div class="level" id="level">1</div></div>
            <div class="info-panel"><h3>Baris</h3><div class="lines" id="lines">0</div></div>
            <div class="controls">
                <h3>Kontrol</h3>
                <div class="control-item"><span>Gerak Kiri:</span><span>←</span></div>
                <div class="control-item"><span>Gerak Kanan:</span><span>→</span></div>
                <div class="control-item"><span>Turun Cepat:</span><span>↓</span></div>
                <div class="control-item"><span>Putar:</span><span>S</span></div>
                <div class="control-item"><span>Jatuhkan:</span><span>Space</span></div>
            </div>
            <button class="btn" onclick="togglePause()">Pause</button>
            <button class="btn" onclick="restartGame()">Restart</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        const BOARD_WIDTH = 10;
        const BOARD_HEIGHT = 20;
        const BLOCK_SIZE = 30;

        const COLORS = [
            '#000000','#FF0000','#00FF00','#0000FF',
            '#FFFF00','#FF00FF','#00FFFF','#FFA500'
        ];

        const TETROMINOES = [
            [],
            [[1,1,1,1]],
            [[2,2],[2,2]],
            [[0,3,0],[3,3,3]],
            [[0,4,4],[4,4,0]],
            [[5,5,0],[0,5,5]],
            [[6,0,0],[6,6,6]],
            [[0,0,7],[7,7,7]]
        ];

        let board = [];
        let currentPiece = null;
        let currentShape = null; // salinan bentuk aktif
        let currentX = 0, currentY = 0;
        let score = 0, level = 1, lines = 0;
        let dropTime = 0, dropInterval = 1000, lastTime = 0;
        let gameRunning = true, paused = false;

        function initBoard(){
            board = [];
            for(let y=0;y<BOARD_HEIGHT;y++){
                board[y] = Array(BOARD_WIDTH).fill(0);
            }
        }

        function drawBlock(x,y,color){
            ctx.fillStyle = COLORS[color];
            ctx.fillRect(x*BLOCK_SIZE,y*BLOCK_SIZE,BLOCK_SIZE,BLOCK_SIZE);
            ctx.strokeStyle = '#333';
            ctx.strokeRect(x*BLOCK_SIZE,y*BLOCK_SIZE,BLOCK_SIZE,BLOCK_SIZE);
        }

        function drawBoard(){
            ctx.clearRect(0,0,canvas.width,canvas.height);
            for(let y=0;y<BOARD_HEIGHT;y++){
                for(let x=0;x<BOARD_WIDTH;x++){
                    if(board[y][x]!==0) drawBlock(x,y,board[y][x]);
                }
            }
        }

        function drawPiece(){
            if(!currentShape) return;
            for(let y=0;y<currentShape.length;y++){
                for(let x=0;x<currentShape[y].length;x++){
                    if(currentShape[y][x]!==0){
                        drawBlock(currentX+x,currentY+y,currentPiece);
                    }
                }
            }
        }

        function isValidMove(shape,x,y){
            for(let py=0;py<shape.length;py++){
                for(let px=0;px<shape[py].length;px++){
                    if(shape[py][px]!==0){
                        const newX = x+px, newY = y+py;
                        if(newX<0||newX>=BOARD_WIDTH||newY>=BOARD_HEIGHT||(newY>=0&&board[newY][newX]!==0)){
                            return false;
                        }
                    }
                }
            }
            return true;
        }

        function placePiece(){
            for(let y=0;y<currentShape.length;y++){
                for(let x=0;x<currentShape[y].length;x++){
                    if(currentShape[y][x]!==0){
                        const by=currentY+y,bx=currentX+x;
                        if(by>=0) board[by][bx]=currentPiece;
                    }
                }
            }
        }

        function clearLines(){
            let cleared=0;
            for(let y=BOARD_HEIGHT-1;y>=0;y--){
                if(board[y].every(c=>c!==0)){
                    board.splice(y,1);
                    board.unshift(Array(BOARD_WIDTH).fill(0));
                    cleared++; y++;
                }
            }
            if(cleared>0){
                lines+=cleared;
                score+=cleared*100*level;
                level=Math.floor(lines/10)+1;
                dropInterval=Math.max(50,1000-(level-1)*100);
                updateDisplay();
            }
        }

        function newPiece(){
            currentPiece=Math.floor(Math.random()*7)+1;
            currentShape=TETROMINOES[currentPiece].map(r=>[...r]); // copy
            currentX=Math.floor(BOARD_WIDTH/2)-1;
            currentY=0;
            if(!isValidMove(currentShape,currentX,currentY)) gameOver();
        }

        function rotateMatrix(matrix){
            return matrix[0].map((_,i)=>matrix.map(row=>row[i]).reverse());
        }

        function rotatePiece(){
            const rotated=rotateMatrix(currentShape);
            if(isValidMove(rotated,currentX,currentY)){
                currentShape=rotated;
            }
        }

        function dropPiece(){
            if(isValidMove(currentShape,currentX,currentY+1)){
                currentY++;
            }else{
                placePiece(); clearLines(); newPiece();
            }
        }

        function hardDrop(){
            while(isValidMove(currentShape,currentX,currentY+1)) currentY++;
            placePiece(); clearLines(); newPiece();
        }

        function updateDisplay(){
            document.getElementById('score').textContent=score;
            document.getElementById('level').textContent=level;
            document.getElementById('lines').textContent=lines;
        }

        function gameOver(){
            gameRunning=false;
            document.getElementById('finalScore').textContent=score;
            document.getElementById('gameOver').style.display='block';
        }

        function gameLoop(time){
            if(!gameRunning||paused){ requestAnimationFrame(gameLoop); return; }
            const delta=time-lastTime; lastTime=time;
            dropTime+=delta;
            if(dropTime>dropInterval){ dropPiece(); dropTime=0; }
            drawBoard(); drawPiece(); requestAnimationFrame(gameLoop);
        }

        document.addEventListener('keydown',(e)=>{
            if(!gameRunning||paused) return;
            switch(e.key){
                case 'ArrowLeft':
                    if(isValidMove(currentShape,currentX-1,currentY)) currentX--; break;
                case 'ArrowRight':
                    if(isValidMove(currentShape,currentX+1,currentY)) currentX++; break;
                case 'ArrowDown': dropPiece(); break;
                case 'ArrowUp':
                case 's':
                case 'S': rotatePiece(); break;
                case ' ': e.preventDefault(); hardDrop(); break;
            }
        });

        function togglePause(){
            paused=!paused;
            document.querySelector('.btn').textContent=paused?'Resume':'Pause';
        }

        function restartGame(){
            initBoard(); score=0; level=1; lines=0; dropInterval=1000;
            gameRunning=true; paused=false;
            document.getElementById('gameOver').style.display='none';
            document.querySelector('.btn').textContent='Pause';
            updateDisplay(); newPiece();
        }

        initBoard(); updateDisplay(); newPiece(); requestAnimationFrame(gameLoop);
    </script>
</body>
</html>
